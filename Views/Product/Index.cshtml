
@{
    ViewData["Title"] = "Index";
}
@Html.AntiForgeryToken()
<p>
    <a asp-action="Create">Create New</a>
</p>
<table class="table" id="t1">
    <thead>
        <tr>
            <th>
                Product Code
            </th>
            <th>
                Product Name
            </th>
            <th>
                Price
            </th>
            <th>
                OnHand
            </th>
            <th>
                Category
            </th>
            <th></th>
            <th></th>
        </tr>
    </thead>
    <tbody>
    </tbody>
</table>
@section Scripts{
    <script>
        $(document).ready(function () {
            $('#t1').DataTable({
                "processing": true, // for show progress bar
                "serverSide": true, // for process server side
                "filter": true, // this is for disable filter (search box)
                "ajax": {
                    "url": "/Product/LoadData",
                    "type": "POST",
                    "datatype": "json"
                },
                "columns": [
                    { "data": "productCode", "name": "productCode", "autoWidth": true },
                    { "data": "productName", "name": "productName", "autoWidth": true },
                    { "data": "price", "name": "price", "autoWidth": true },
                    { "data": "onHand", "name": "onHand", "autoWidth": true },
                    { "data": "categoryId", "name": "categoryId", "autoWidth": true },
                    {
                        "render": function (data, type, full, meta) {
                            return '<a class="btn btn-info" href="/Product/Edit/' + full.productId + '">Edit</a>';
                        }
                    },
                    {
                        render: function (data, type, row) {
                            return "<a href='#' class='btn btn-danger' onclick=DeleteData('" + row.productId + "');>Delete</a>";
                        }
                    },
                ]

            });
        });
        function DeleteData(id) {
            var result = confirm("Do you want to delete this record?");
            if (result) {
                 var url = '@Url.Content("~/")' + "Product/Delete/" + id;
                    var token = $("[name='__RequestVerificationToken']").val();
                    $.post(url, { ID: id, __RequestVerificationToken: token }, function (data)
                    {
                        if (data)
                        {
                            oTable = $('#t1').DataTable();
                            oTable.draw();
                        }
                        else
                        {
                            alert("Something Went Wrong!");
                        }
                    });
            }
        }
    </script>
}
